---
layout: "post"
title: "Rich: Tree"
date: 2024-07-27
tags: ["til"]
---

Every now and then I'll see a question on [Stack Overflow](https://stackoverflow.com/){:target="_blank"} with a nice little directory tree.
I've tried to make one before on my Windows machine, but it never turns out as pretty as I want.

Lately I've found myself browsing the [Calm Code](https://calmcode.io/){:target="_blank"} website picking little tidbits.
In one of my more recent ventures I came across [`rich`](https://github.com/Textualize/rich){:target="_blank"},
and I've started to integrate it into my notebooks because it makes everything a little more... âœ¨richâœ¨.

> [!NOTE]
> 
> It also happens to be one of the [`typer`](https://typer.tiangolo.com/){:target="_blank"} dependencies,
> which is why everything comes out looking so nice in the terminal.
> You can see some examples in my [last post, _Typer: Context_]({{ site.baseurl }}{% link _posts/2024-07-10-til-typer.md %}){:target="_blank"}.

While exploring the [`rich` tutorial](https://calmcode.io/course/rich/introduction){:target="_blank"} on Calm Code,
I learned that it can create *really* nice looking directory trees.
As Vincentâ€”the Calm Code creatorâ€”says in his [video](https://calmcode.io/course/rich/trees){:target="_blank"},
you can find an example tree on [his GitHub profile](https://github.com/koaning){:target="_blank"}.

I really like this tree structure.
I don't know when I'll need one, but I decided to learn how to make one just in case I ever do. ðŸ¤·
Here's what I did.

> [!NOTE]
> 
> Install `rich` if you want to follow along.
> ```shell
> $ pip install rich
> ```

```python
"""Contents of tree/main.py"""

from rich import print
from rich.tree import Tree
import typer

app = typer.Typer()


def main() -> None:
    """An example tree.

    I copied almost verbatim from the rich.Tree tutorial.
    """
    tree = Tree("Example Tree")
    tree.add("foo")
    tree.add("bar")
    print(tree)


if __name__ == "__main__":
    typer.run(main)

```

Nothing fancy in this scriptâ€”just the basic tutorial from the `rich` docs.
I did add `typer` to make it a little more intuitive to run from the command line,
but it still creates a tree that looks like this:

```text
Example Tree
â”œâ”€â”€ foo
â””â”€â”€ bar
```

Let's make it a bit more useful.

```python
"""Contents of tree/main.py"""

from pathlib import Path

from rich import print
from rich.tree import Tree
import typer

app = typer.Typer()


def main(
        directory: Path = typer.Argument(
            help="Directory path to represent as a tree."
        ),
) -> None:
    """Represent a path as a tree."""
    root = directory.cwd().as_posix()
    tree = Tree(root)
    for path in directory.iterdir():
        branch = path.as_posix()
        tree.add(branch)

    print(tree)


if __name__ == "__main__":
    typer.run(main)

```

Now we're getting somewhere.
This script takes a directory, iterates over its contents,
and creates a two-level tree (the directory and its contents).
Here's the output of my local directory.

```text
C:/Users/Ian Thompson/Dreams/it176131.github.io
â”œâ”€â”€ .env
â”œâ”€â”€ .git
â”œâ”€â”€ .gitattributes
â”œâ”€â”€ .github
â”œâ”€â”€ .gitignore
â”œâ”€â”€ .idea
â”œâ”€â”€ .ipynb_checkpoints
â”œâ”€â”€ .jekyll-cache
â”œâ”€â”€ about.md
â”œâ”€â”€ assets
â”œâ”€â”€ index.md
â”œâ”€â”€ ipynb_to_post.py
â”œâ”€â”€ LICENSE
â”œâ”€â”€ main.py
â”œâ”€â”€ notebooks
â”œâ”€â”€ pkg.py
â”œâ”€â”€ README.md
â”œâ”€â”€ test_main.py
â”œâ”€â”€ tree
â”œâ”€â”€ _config.yml
â”œâ”€â”€ _posts
â”œâ”€â”€ _site
â””â”€â”€ __pycache__
```

I like it, but I think I'd like it more if I could optionally show the private files/directories, i.e., the ones that start with periods.
Let me try to do that.

```python
"""Contents of tree/main.py"""

from pathlib import Path
from typing import Annotated

from rich import print
from rich.tree import Tree
import typer

app = typer.Typer()


def main(
        directory: Path = typer.Argument(
            help="Directory path to represent as a tree."
        ),
        all: Annotated[
            bool,
            typer.Option(
                "--all/", "-a", help="Show all files."
            ),
        ] = False
) -> None:
    """Represent a path as a tree."""
    root = directory.cwd().as_posix()
    tree = Tree(root)
    for path in directory.iterdir():
        if not all and path.name.startswith("."):
            continue

        branch = path.as_posix()
        tree.add(branch)

    print(tree)


if __name__ == "__main__":
    typer.run(main)

```